\begin{tikzpicture}
\node[black,draw=black,line width=2pt, dashed,dash pattern=on 7pt off 2pt,shape=rectangle,inner sep=30mm,rounded corners=1cm, rectangle split, rectangle split horizontal, rectangle split parts=3, rectangle split empty part height=7ex] (tp) at (-2,-2.5) { \nodepart {two}  \nodepart {three} };
\node [font=\Large] at (tp.text) [above=3.5]{root};
\node [font=\Large] at (tp.two) [above=3.5]{internal};
\node [font=\Large] at (tp.three) [above=3.4]{tip};
\node at ($(tp.two)-(-2.0,2.6)$) {$i \in$ internals};
\node at ($(tp.three)-(-2.25,2.6)$) {$i \in$ tips};
\node at ($(tp.text)-(-2.25,2.6)$) {$i =$ root};
\node [detnode] (btimeI) at ($(tp.two)-(2.0,0.5)$) {\LARGE $t_i$};
\node [detnode] (btimet) at ($(tp.three)-(2.0,0.5)$) {\LARGE $t_i$};
\coordinate (Middle) at ($(btimeI)!0.5!(btimet)$);
%\node [detnode] (psi) at ($(Middle)-(0,3.5)$) {\LARGE $\Psi$};
%\draw [dtaro] (psi) edge[bend left=40] (btimeI) ;
\node [snode] (ri) at ($(tp.two)-(0,0)$) {\LARGE $n_i$};
\node [snode] (rpi) at ($(tp.two)+(2,2)$) {$r_{\tilde{p}(i)}$};
\node [detnode] (lai) at ($(ri)-(0,1.75)$) {\LARGE $r_i$};
%\draw [taro] (rpi) -- (ri) ;
\draw [dtaro] (rpi) edge[bend left=20] (lai) ;
\draw [dtaro] (ri) -- (lai) ;
%\draw [dtaro] (psi) edge[bend right=40] (btimet) ;
\node [snode] (rt) at ($(tp.three)-(0,0)$) {\LARGE $n_i$};
\node [snode] (rpt) at ($(tp.three)+(2,2)$) {$r_{\tilde{p}(i)}$};
\node [detnode] (lat) at ($(rt)-(0,1.75)$) {\LARGE $r_i$};
\node [detnode] (sigi) at ($(btimeI)+(0,3)$) {\LARGE $\sigma_i$};
\draw [dtaro] (btimeI) -- (sigi) ;
%\draw [taro] (rpt) -- (rt) ;
\draw [dtaro] (rpt) edge[bend left=20] (lat) ;
\draw [dtaro] (rt) -- (lat) ;
\node [snode] (rr) at ($(tp.text)-(0,0)$) {\LARGE $r_i$};
\node [constnode] (rra) at ($(rr)+(-1,1.5)$) {\LARGE $\alpha_i$};
\node [constnode] (rrb) at ($(rr)+(1,1.5)$) {\LARGE $\beta_i$};
\draw [taro] (rra) -- (rr) ;
\draw [taro] (rrb) -- (rr) ;
\node [detnode] (sigt) at ($(btimet)+(0,3)$) {\LARGE $\sigma_i$};
\node [snode] (nu) at ($(Middle)+(0,6)$) {\LARGE $\nu$};
\node [constnode] (nua) at ($(nu)+(-1,1.5)$) {\LARGE $\alpha_{\nu}$};
\node [constnode] (nub) at ($(nu)+(1,1.5)$) {\LARGE $\beta_{\nu}$};
\draw [taro] (nua) -- (nu) ;
\draw [taro] (nub) -- (nu) ;
\draw [dtaro] (nu) edge[bend right=40] (sigi) ;
\draw [taro] (sigi) -- (ri) ;
\draw [dtaro] (btimet) -- (sigt) ;
\draw [dtaro] (nu) edge[bend left=40] (sigt) ;
\draw [taro] (sigt) -- (rt) ;
\node[detnode] (mui) at ($(ri)+(0,1.75)$) {\LARGE $\mu_i$} ;
\node[detnode] (mut) at ($(rt)+(0,1.75)$) {\LARGE $\mu_i$} ;
\draw [dtaro] (rpi) -- (mui) ;
\draw [dtaro] (rpt) -- (mut) ;
\draw [dtaro] (sigi) -- (mui) ;
\draw [dtaro] (sigt) -- (mut) ;
\draw [taro] (mui) -- (ri) ;
\draw [taro] (mut) -- (rt) ;
\node[snode] (topo) at ($(tp)+(-10.5,0)$) {\LARGE $\Psi$};
\draw[-,line width=2pt] (topo) -- (tp) ;
\node (ddd1) at ($(lai)+(0,-3)$) {\scriptsize to the phyloCTMC} ;
\node (ddd3) at ($(lat)+(0,-3)$) {\scriptsize to the phyloCTMC} ;
\draw [dtaro] (lai) -- (ddd1) ;
\draw [dtaro] (lat) -- (ddd3) ;
\node at ($(rr)+(0,2.25)$) {Gamma};
\node at ($(nu)+(0,2.25)$) {Gamma};
\node at ($(topo)+(0,-0.75)$) {time tree};
\node at ($(nu)+(0,-0.75)$) {variance parameter};
\end{tikzpicture}


